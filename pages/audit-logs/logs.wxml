<!-- pages/audit-logs/logs.wxml -->
<view class="container">
  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-section">
    <view class="stat-card">
      <text class="stat-value">{{statistics.total || 0}}</text>
      <text class="stat-label">æ€»æ“ä½œæ•°</text>
    </view>
    <view class="stat-card">
      <text class="stat-value primary">{{statistics.today || 0}}</text>
      <text class="stat-label">ä»Šæ—¥æ“ä½œ</text>
    </view>
  </view>

  <!-- ç­›é€‰åŒºåŸŸ -->
  <view class="filter-section">
    <picker class="filter-picker" mode="selector" range="{{modules}}" value="{{moduleIndex}}" bindchange="onModuleChange">
      <view class="picker-view">
        <text class="picker-text">{{moduleIndex >= 0 ? modules[moduleIndex] : 'å…¨éƒ¨æ¨¡å—'}}</text>
        <text class="picker-arrow">â–¼</text>
      </view>
    </picker>
    <button class="filter-btn" bindtap="clearFilters">é‡ç½®</button>
  </view>

  <!-- æ—¥å¿—åˆ—è¡¨ -->
  <view class="logs-list">
    <view class="log-item" wx:for="{{logs}}" wx:key="id">
      <view class="log-header">
        <text class="log-user">{{item.username}}</text>
        <text class="log-time">{{item.created_at}}</text>
      </view>
      <view class="log-content">
        <text class="log-module">{{item.module}}</text>
        <text class="log-separator">â€¢</text>
        <text class="log-action">{{item.action}}</text>
      </view>
      <view class="log-details" wx:if="{{item.details}}">
        <text class="details-text">{{item.details}}</text>
      </view>
      <view class="log-footer" wx:if="{{item.ip_address}}">
        <text class="ip-text">IP: {{item.ip_address}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore}}">
    <button class="load-btn" bindtap="loadMore" loading="{{loading}}">åŠ è½½æ›´å¤š</button>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{logs.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— æ“ä½œè®°å½•</text>
  </view>
</view>
