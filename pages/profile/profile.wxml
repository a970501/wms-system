<!-- pages/profile/profile.wxml -->
<view class="container">
  <!-- 用户信息 -->
  <view class="user-card">
    <view class="avatar">
      <text class="avatar-text">{{userInfo.username ? userInfo.username[0] : 'U'}}</text>
    </view>
    <view class="user-info">
      <text class="username">{{userInfo.username || '用户'}}</text>
      <text class="role">{{userInfo.role === 'ADMIN' ? '管理员' : '普通用户'}}</text>
    </view>
  </view>

  <!-- 统计信息 -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-value">{{monthPiecework}}</text>
      <text class="stat-label">本月计件</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-value">¥{{monthAmount}}</text>
      <text class="stat-label">本月金额</text>
    </view>
  </view>

  <!-- 功能列表 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="goToMyRecords">
      <text class="menu-icon">📋</text>
      <text class="menu-text">我的计件记录</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToAdvancedSearch">
      <text class="menu-icon">🔍</text>
      <text class="menu-text">高级查询</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 规则管理（仅管理员可见） -->
  <view class="menu-section" wx:if="{{userInfo.role === 'ADMIN'}}">
    <view class="section-title">规则管理</view>
    <view class="menu-item" bindtap="goToStorageRules">
      <text class="menu-icon">📦</text>
      <text class="menu-text">入库规则</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToAssemblyRules">
      <text class="menu-icon">🔧</text>
      <text class="menu-text">装配规则</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToPriceTable">
      <text class="menu-icon">💰</text>
      <text class="menu-text">单价表管理</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToReconcile">
      <text class="menu-icon">🧾</text>
      <text class="menu-text">对账</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 日志管理（仅管理员可见） -->
  <view class="menu-section" wx:if="{{userInfo.role === 'ADMIN'}}">
    <view class="section-title">日志管理</view>
    <view class="menu-item" bindtap="goToStorageLogs">
      <text class="menu-icon">📊</text>
      <text class="menu-text">入库日志</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToAuditLogs">
      <text class="menu-icon">📝</text>
      <text class="menu-text">操作日志</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToNotificationSettings">
      <text class="menu-icon">🔔</text>
      <text class="menu-text">日志通知设置</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToDeveloperTools">
      <text class="menu-icon">🛠️</text>
      <text class="menu-text">开发者工具</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 其他设置 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="goToWebsite">
      <text class="menu-icon">🌐</text>
      <text class="menu-text">网页版</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="clearCache">
      <text class="menu-icon">🗑️</text>
      <text class="menu-text">清除缓存</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="showAbout">
      <text class="menu-icon">ℹ️</text>
      <text class="menu-text">关于</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 退出登录 -->
  <button class="logout-btn" bindtap="handleLogout">退出登录</button>

  <!-- 版本信息 -->
  <view class="version-info">
    <text>Version 7.0.1</text>
  </view>
</view>

